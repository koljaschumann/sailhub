events {
    worker_connections 1024;
}

http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;
    
    sendfile on;
    keepalive_timeout 65;
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml;

    server {
        listen 80;
        server_name sailhub.aitema.de localhost;
        root /usr/share/nginx/html;
        index index.html;

        # Main web app (root)
        location / {
            try_files $uri $uri/ /index.html;
        }

        # Startgelder module
        location /startgelder {
            alias /usr/share/nginx/html/startgelder;
            try_files $uri $uri/ /startgelder/index.html;
        }

        # Saisonplanung module
        location /saisonplanung {
            alias /usr/share/nginx/html/saisonplanung;
            try_files $uri $uri/ /saisonplanung/index.html;
        }

        # Eventanmeldung module
        location /eventanmeldung {
            alias /usr/share/nginx/html/eventanmeldung;
            try_files $uri $uri/ /eventanmeldung/index.html;
        }

        # Schadensmeldung module
        location /schadensmeldung {
            alias /usr/share/nginx/html/schadensmeldung;
            try_files $uri $uri/ /schadensmeldung/index.html;
        }

        # Saisoncharter module
        location /saisoncharter {
            alias /usr/share/nginx/html/saisoncharter;
            try_files $uri $uri/ /saisoncharter/index.html;
        }

        # Jugendleistungsfonds module
        location /jugendleistungsfonds {
            alias /usr/share/nginx/html/jugendleistungsfonds;
            try_files $uri $uri/ /jugendleistungsfonds/index.html;
        }

        # Jahresauswertung module
        location /jahresauswertung {
            alias /usr/share/nginx/html/jahresauswertung;
            try_files $uri $uri/ /jahresauswertung/index.html;
        }

        # Spendenportal module
        location /spendenportal {
            alias /usr/share/nginx/html/spendenportal;
            try_files $uri $uri/ /spendenportal/index.html;
        }

        # Cache static assets
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
    }
}
